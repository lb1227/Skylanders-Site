<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Collectibles</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      padding: 20px;
      background-color: #f4f4f4;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #ddd;
      margin: 5px 0;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-radius: 5px;
    }
    button {
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 3px;
    }
    img {
      width: 200px;
      height: auto;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .collectible-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>My Collectibles</h2>
    <label for="gameSelector">Select Game:</label>
    <select id="gameSelector" onchange="switchGame()">
      <option value="Spyro's Adventure">Spyro's Adventure</option>
      <option value="Giants">Giants</option>
    </select>
    <div id="collectibleContainer">
      <img id="collectibleImage" alt="Collectible Image" />
      <p id="collectibleName"></p>
      <select id="statusInput">
        <option value="Have it">Have it</option>
        <option value="Don't have it">Don't have it</option>
      </select>
      <button id="nextButton">Next</button>
    </div>
    <h3>Collected Items</h3>
    <ul id="collectiblesList"></ul>
  </div>
  <script>
    const games = {
      "Spyro's Adventure": [
        { name: "Spyro", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Spyro1.png" },
        { name: "Trigger Happy", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/TriggerHappy1.png" }
      ],
      "Giants": [
        { name: "Tree Rex", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/TreeRex.png" },
        { name: "Pop Fizz", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/PopFizz1.png" }
      ]
    };

    let currentGame = "Spyro's Adventure";
    let collectibles = games[currentGame];
    let collectiblesQueue = [...collectibles];
    let collectedItems = [];
    let lastItem = null;

    function showCurrentCollectible() {
      if (collectiblesQueue.length > 0) {
        document.getElementById("collectibleImage").src = collectiblesQueue[0].image;
        document.getElementById("collectibleName").innerText = collectiblesQueue[0].name;
      } else {
        document.getElementById("collectibleContainer").innerHTML = "<p>All collectibles reviewed!</p>";
      }
    }

    document.getElementById("nextButton").onclick = () => {
      const status = document.getElementById("statusInput").value;
      const current = collectiblesQueue[0];
      if (!current) return;

      if (status === "Don't have it") {
        collectiblesQueue.shift();
        showCurrentCollectible();
        saveProgress();
        return;
      }

      collectiblesQueue.shift();

      const list = document.getElementById("collectiblesList");
      const li = document.createElement("li");
      li.innerHTML = `
        <div class="collectible-item">
          <img src="${current.image}" alt="${current.name}" />
          <span>${current.name} - <strong>${status}</strong></span>
        </div>
        <button onclick="removeCollectible('${current.name}', this)">Remove</button>
      `;
      list.appendChild(li);
      collectedItems.push(current);
      lastItem = current;

      showCurrentCollectible();
      saveProgress();
    };

    function removeCollectible(name, button) {
      const li = button.closest('li');
      if (li) li.remove();

      const index = collectedItems.findIndex(c => c.name === name);
      if (index !== -1) {
        const [restored] = collectedItems.splice(index, 1);
        collectiblesQueue.unshift(restored);
        showCurrentCollectible();
        saveProgress();
      }
    }

    function renderCollectedList() {
      const list = document.getElementById("collectiblesList");
      list.innerHTML = "";
      collectedItems.forEach(item => {
        const li = document.createElement("li");
        li.innerHTML = `
          <div class="collectible-item">
            <img src="${item.image}" alt="${item.name}" />
            <span>${item.name} - <strong>Have it</strong></span>
          </div>
          <button onclick="removeCollectible('${item.name}', this)">Remove</button>
        `;
        list.appendChild(li);
      });
    }

    function saveProgress() {
  const user = localStorage.getItem("sky_user") || "guest";
  const key = `sky_progress_${user}_${currentGame}`;
  const data = {
    collected: collectedItems,
    queue: collectiblesQueue
  };
  localStorage.setItem(key, JSON.stringify(data));
}

    function loadProgress(user) {
      const key = `sky_progress_${user}_${currentGame}`;
      const saved = localStorage.getItem(key);
      if (saved) {
        const parsed = JSON.parse(saved);
        collectedItems = parsed.collected || [];
        collectiblesQueue = parsed.queue || [...collectibles];
        renderCollectedList();
      } else {
        collectedItems = [];
        collectiblesQueue = [...collectibles];
      }
    }

    function switchGame() {
  const user = localStorage.getItem("sky_user") || "guest";
  currentGame = document.getElementById("gameSelector").value;
  collectibles = games[currentGame];
  loadProgress(user);
  lastItem = null;
  document.getElementById("collectiblesList").innerHTML = "";
  renderCollectedList();
  showCurrentCollectible();
}

    window.onload = () => {
      const user = localStorage.getItem("sky_user") || "guest";
      loadProgress(user);
      showCurrentCollectible();
    };
  </script>
</body>
</html>
