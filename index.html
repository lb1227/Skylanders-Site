<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Skylanders Tracker</title>
  <style>
    :root {
      --bg: #121212;
      --card-bg: #1f1f1f;
      --text: #ffffff;
      --accent: #4caf50;
      --button: #e53935;
      --button-hover: #d32f2f;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: var(--bg);
      color: var(--text);
    }
    nav {
      background-color: #000;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    nav h2 {
      margin: 0;
    }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.4);
    }
    select, button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      margin-top: 1rem;
    }
    select {
      background-color: #2a2a2a;
      color: white;
    }
    button {
      background-color: var(--button);
      color: white;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: var(--button-hover);
    }
    img {
      width: 200px;
      height: auto;
      border-radius: 10px;
      margin-bottom: 0.5rem;
    }
    #collectibleContainer {
      text-align: center;
      margin: 2rem 0;
    }
    #progressBar {
      height: 24px;
      background: #333;
      border-radius: 12px;
      overflow: hidden;
      margin: 1rem 0;
      position: relative;
    }
    #progressFill {
      height: 100%;
      width: 0%;
      background: var(--accent);
      transition: width 0.4s ease;
    }
    #progressText {
      position: absolute;
      width: 100%;
      text-align: center;
      font-weight: bold;
      line-height: 24px;
      color: white;
    }
    .qty-input.invalid {
      border: 2px solid red;
      background-color: #3a0000;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .card {
      background: #2a2a2a;
      border-radius: 12px;
      padding: 1rem;
      text-align: center;
      position: relative;
      box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }
    .card img {
      width: 100%;
      max-width: 160px;
      height: auto;
      border-radius: 10px;
      margin-bottom: 0.5rem;
    }
    .card .qty-input {
      margin-top: 0.5rem;
      width: 60px;
    }
    .card button {
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <nav>
    <h2>Skylanders Tracker</h2>
    <div id="authButtonsNav">
      <a href="inventory.html" style="color: white; margin-left: 1rem; text-decoration: none; font-size: 1rem;">Inventory</a>
      <a href="totals.html" style="color: white; margin-left: 1rem; text-decoration: none; font-size: 1rem;">User Totals</a>
    </div>
  </nav>
  <div class="container">
    <h2>My Collectibles</h2>
    <label for="gameSelector">Select Game:</label>
    <select id="gameSelector">
      <option value="Spyro's Adventure">Spyro's Adventure</option>
      <option value="Giants">Giants</option>
    </select>
    <div id="progressBar">
      <div id="progressFill"></div>
      <span id="progressText">0%</span>
    </div>
    <div id="collectibleContainer">
      <img id="collectibleImage" alt="Collectible Image" />
      <p id="collectibleName"></p>
      <select id="statusInput">
        <option value="Have it">Have it</option>
        <option value="Don't have it">Don't have it</option>
      </select>
      <br />
      <button id="nextButton">Next</button>
    </div>
    <div style="text-align:center; margin-bottom: 1rem;">
      <label for="filterSelect">Filter:</label>
      <select id="filterSelect" style="margin-left: 0.5rem;">
        <option value="all">All</option>
        <option value="Have it">Have It</option>
        <option value="Don't have it">Don't Have It</option>
      </select>
    </div>
    <div class="card-grid" id="cardGrid"></div>
  </div>
<script>
const games = {
  "Spyro's Adventure": [
    { name: "Spyro", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Spyro1.png" },
    { name: "Trigger Happy", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/TriggerHappy1.png" },
    { name: "Stealth Elf", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/StealthElf1.png" },
    { name: "Gill Grunt", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/GillGrunt1.png" },
    { name: "Eruptor", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Eruptor1.png" }
  ],
  "Giants": [
    { name: "Bouncer", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Bouncer.png" },
    { name: "Crusher", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Crusher.png" },
    { name: "Eye-Brawl", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/EyeBrawl1.png" },
    { name: "Hot Head", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/HotHead.png" },
    { name: "Ninjini", image: "https://skylanderscharacterlist.com/wp-content/uploads/2013/02/Ninjini.png" }
  ]
};
let currentGame = "Spyro's Adventure";
let collectibles = games[currentGame];
let collectiblesQueue = [...collectibles];
let collectedItems = [];
document.getElementById("nextButton").addEventListener("click", () => {
  const status = document.getElementById("statusInput").value;
  const current = collectiblesQueue[0];
  if (!current) return;
  collectiblesQueue.shift();
  collectedItems.push({ ...current, status });
  renderCollectedList();
  showCurrentCollectible();
  updateProgress();
  saveProgress();
});
document.getElementById("gameSelector").addEventListener("change", switchGame);
function switchGame() {
  const user = localStorage.getItem("sky_user") || "guest";
  saveProgress();
  currentGame = document.getElementById("gameSelector").value;
  collectibles = games[currentGame];
  loadProgress(user);
  renderCollectedList();
  showCurrentCollectible();
  updateProgress();
}
function loadProgress(user) {
  const key = `sky_progress_${user}_${currentGame}`;
  const saved = localStorage.getItem(key);
  if (saved) {
    const parsed = JSON.parse(saved);
    collectedItems = parsed.collected || [];
    collectiblesQueue = parsed.queue || [...collectibles];
  } else {
    collectedItems = [];
    collectiblesQueue = [...collectibles];
  }
}
function renderCollectedList() {
  const grid = document.getElementById("cardGrid");
  const filter = document.getElementById("filterSelect").value;
  grid.innerHTML = "";
  collectedItems.forEach(item => {
    if (filter !== "all" && item.status !== filter) return;
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${item.image}" alt="${item.name}" />
      <div><strong>${item.name}</strong></div>
      ${item.status === 'Have it' ? `<input type='number' min='1' value='${item.quantity || 1}' class='qty-input' data-name='${item.name}'>` : ''}
      <button class="remove-button" data-name="${item.name}" data-status="${item.status}">Remove</button>
    `;
    grid.appendChild(card);
    const removeBtn = card.querySelector(".remove-button");
    removeBtn.addEventListener("click", function() {
      removeCollectible(this.getAttribute("data-name"), this, this.getAttribute("data-status"));
    });
    const qtyInput = card.querySelector(".qty-input");
    if (qtyInput) {
      qtyInput.addEventListener("change", function () {
        let qty = parseInt(this.value);
        const tooltip = document.createElement("div");
        tooltip.textContent = "Please enter a whole number greater than or equal to 1";
        tooltip.style.position = "absolute";
        tooltip.style.background = "#f44336";
        tooltip.style.color = "#fff";
        tooltip.style.padding = "5px 10px";
        tooltip.style.borderRadius = "5px";
        tooltip.style.fontSize = "0.9rem";
        tooltip.style.zIndex = 10;
        tooltip.style.top = (this.getBoundingClientRect().top - 35 + window.scrollY) + "px";
        tooltip.style.left = (this.getBoundingClientRect().left + window.scrollX) + "px";
        if (!Number.isInteger(qty) || qty < 1) {
          qty = 1;
          this.value = 1;
          this.classList.add("invalid");
          document.body.appendChild(tooltip);
          setTimeout(() => {
            this.classList.remove("invalid");
            document.body.removeChild(tooltip);
          }, 1000);
        } else {
          this.classList.remove("invalid");
        }
        const found = collectedItems.find(c => c.name === this.dataset.name && c.status === "Have it");
        if (found) {
          found.quantity = qty;
          saveProgress();
        }
      });
    }
  });
}
function showCurrentCollectible() {
  if (collectiblesQueue.length > 0) {
    document.getElementById("collectibleImage").src = collectiblesQueue[0].image;
    document.getElementById("collectibleName").innerText = collectiblesQueue[0].name;
  } else {
    document.getElementById("collectibleImage").src = "";
    document.getElementById("collectibleName").innerText = "";
  }
}
function updateProgress() {
  const total = games[currentGame].length;
  const collected = collectedItems.length;
  const percent = Math.round((collected / total) * 100);
  document.getElementById("progressFill").style.width = percent + "%";
  document.getElementById("progressText").innerText = percent + "%";
}
function saveProgress() {
  const user = localStorage.getItem("sky_user") || "guest";
  const key = `sky_progress_${user}_${currentGame}`;
  const data = {
    collected: collectedItems,
    queue: collectiblesQueue
  };
  localStorage.setItem(key, JSON.stringify(data));
}
function removeCollectible(name, button, status) {
  const index = collectedItems.findIndex(c => c.name === name && c.status === status);
  if (index !== -1) {
    const [restored] = collectedItems.splice(index, 1);
    collectiblesQueue.unshift({ name: restored.name, image: restored.image });
    showCurrentCollectible();
    renderCollectedList();
    updateProgress();
    saveProgress();
  }
}
document.getElementById("filterSelect").addEventListener("change", renderCollectedList);
switchGame();
</script>
</body>
</html>
